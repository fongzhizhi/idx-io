## 项目说明

这是一个IDX协议导入导出器工具库，用于处理IDX（EDMD Data Exchange）格式的数据交换。IDX是一个用于ECAD/MCAD协作的标准协议，主要用于PCB设计数据的交换。

**技术栈：**
- TypeScript - 主要开发语言，提供完整的类型定义
- xmlbuilder2 - XML文档构建和序列化
- Vitest - 单元测试框架
- ESLint + Prettier - 代码质量和格式化工具
- tsup - TypeScript构建工具

**实现思路：**
项目采用分层架构设计，主要包含三个核心模块：
1. **类型定义层** (`src/types/`) - 完整的IDX协议类型定义，包括核心类型、几何类型、项目类型等
2. **导出器模块** (`src/exporter/`) - 负责将ECAD数据转换为IDX格式，包含模型构建器(Builder)和格式生成器(Writer)
3. **导入器模块** (`src/importer/`) - 负责解析IDX文件并转换为内部数据结构（计划中）

导出流程：ECAD数据 → IDXBuilder构建EDMDDataSet → IDXWriter序列化为XML → 输出IDX文件

## 项目结构

```
src/
├── index.ts                    # 主入口文件
├── core/                       # 核心工具模块
│   └── utils/
│       └── idx-namespace.utils.ts  # IDX命名空间工具函数
├── exporter/                   # 导出器模块
│   ├── index.ts               # 导出器入口
│   ├── builder/               # 模型构建器
│   │   ├── IDXBuilder.ts      # IDX模型构建器实现
│   │   └── config/
│   │       └── idx-builder.config.ts  # 构建器默认配置
│   ├── idx-exporter/          # IDX导出器
│   │   ├── IDXExporter.ts     # 导出器主类
│   │   └── config/
│   │       └── idx-exporter.config.ts  # 导出器默认配置
│   └── writer/                # 格式生成器
│       ├── IDXWriter.ts       # IDX格式生成器实现
│       └── config/
│           └── idx-writer.config.ts    # 生成器默认配置
├── importer/                   # 导入器模块
│   ├── index.ts               # 导入器入口
│   └── IDXImporter.ts         # IDX导入器实现（计划中）
├── types/                      # 类型定义
│   ├── core/                  # 核心类型定义
│   │   ├── index.ts           # 核心类型导出入口
│   │   ├── base.types.ts      # 基础类型定义
│   │   ├── dataset.types.ts   # 数据集类型定义
│   │   ├── enums.ts           # 枚举类型定义
│   │   ├── geometry.types.ts  # 几何类型定义
│   │   ├── items.types.ts     # 项目类型定义
│   │   ├── namespace.types.ts # 命名空间类型定义
│   │   └── shape-element.types.ts  # 形状元素类型定义
│   ├── ecad/                  # ECAD相关类型
│   │   └── ecad.interface.ts  # ECAD数据接口
│   └── exporter/              # 导出器相关类型
│       ├── builder/
│       │   └── idx-builder.interface.ts    # 构建器接口
│       ├── idx-exporter/
│       │   └── idx-exporter.interface.ts   # 导出器接口
│       └── writer/
│           └── idx-writer.interface.ts     # 生成器接口
└── utils/                      # 通用工具函数
    ├── array.utils.ts         # 数组工具函数
    ├── number.utils.ts        # 数字工具函数
    └── object.utils.ts        # 对象工具函数
```

## 项目完整代码

### 主入口文件

1. `src/index.ts`

   ```ts
   // ============= IDX IO 项目 =============
   
   // ------------ IDX 导出器模块 ------------
   export * from './exporter';
   
   // ------------ IDX 导入器模块 ------------
   export * from './importer';
   ```

### exporter/

1. `src/exporter/index.ts`

   ```ts
   // ============= IDX 导出器模块 =============

   import { IDXExporter } from './idx-exporter/IDXExporter';

   export { IDXExporter };
   ```

2. `src/exporter/builder/IDXBuilder.ts`

   ```ts
   import { EDMDDataSet } from '../../types/core';
   import { ECADData } from '../../types/ecad/ecad.interface';
   import { IDXBuildConfig } from '../../types/exporter/builder/idx-builder.interface';
   import { DefaultIDXWriteConfig } from '../writer/config/idx-writer.config';
   import { DefaultIDXBuildConfig } from './config/idx-builder.config';

   /**
    * IDX 模型构建器
    * @description 负责将 ECAD 数据组装构建为完整的 EDMDDataSet 数据
    */
   export class IDXBuilder {
   	// ============= 状态量 =============

   	// ------------ 私有变量 ------------
   	/** 配置 */
   	private config = DefaultIDXBuildConfig;

   	// ------------ 构建状态量 ------------
   	/** ECAD 数据 */
   	private ecadData: ECADData | undefined;

   	/** IDX 模型构建器 */
   	constructor(config?: IDXBuildConfig) {
   		if (config) {
   			this.config = config;
   		}
   	}

   	// ============= 构建相关 =============
   	/** 构建 EDMDDataSet */
   	build(ecadData: ECADData): EDMDDataSet {
   		// TODO: 待实现
   		this.ecadData = ecadData;
   	}
   }
   ```

3. `src/exporter/builder/config/idx-builder.config.ts`

   ```ts
   import { GlobalUnit } from '../../../types/core';
   import { IDXBuildConfig } from '../../../types/exporter/builder/idx-builder.interface';

   /** IDX 模型构建-默认配置 */
   export const DefaultIDXBuildConfig: IDXBuildConfig = {
   	useSimplified: true,
   	unit: GlobalUnit.UNIT_MM,
   	precision: 3,
   };
   ```

4. `src/exporter/idx-exporter/IDXExporter.ts`

   ```ts
   import { ECADData } from '../../types/ecad/ecad.interface';
   import { IDXExportConfig, IDXExportResult } from '../../types/exporter/idx-exporter/idx-exporter.interface';
   import { IDXBuilder } from '../builder/IDXBuilder';
   import { IDXWriter } from '../writer/IDXWriter';
   import { DefaultIDXExportConfig } from './config/idx-exporter.config';

   /**
    * IDX 格式导出器
    * @description 将 ECAD 数据导出为 IDX文件或源码
    */
   export class IDXExporter {
   	// ============= 状态量 =============
   	// ------------ 私有变量 ------------
   	/** 配置 */
   	private config = DefaultIDXExportConfig;
   	/** 模型构建器 */
   	private readonly builder: IDXBuilder;
   	/** 格式生成器 */
   	private readonly writer: IDXWriter;

   	// ------------ 导出状态量 ------------

   	/** IDX 格式导出器 */
   	constructor(config?: IDXExportConfig) {
   		if (config) {
   			this.config = config;
   		}
   		const finalConfig = this.config;
   		this.builder = new IDXBuilder(finalConfig.buildConfig);
   		this.writer = new IDXWriter(finalConfig.writeConfig);
   	}

   	// ============= 构建相关 =============
   	/** 导出 IDX 数据 */
   	export(ecadData: ECADData): IDXExportResult {
   		// # 构建 IDX 模型
   		const dataSet = this.builder.build(ecadData);

   		// # 生成 IDX 源码
   		const idxSource = this.writer.serialize(dataSet);

   		// # 组织导出结果
   		const exportResult: IDXExportResult = null; // TODO: 待实现
   		return exportResult;
   	}
   }
   ```

5. `src/exporter/idx-exporter/config/idx-exporter.config.ts`

   ```ts
   import { IDXExportConfig } from '../../../types/exporter/idx-exporter/idx-exporter.interface';

   /** IDX 模型导出-默认配置 */
   export const DefaultIDXExportConfig: IDXExportConfig = {
   	output: {
   		designName: '',
   	},
   	collaboration: {
   		creatorSystem: 'ECAD',
   		creatorCompany: 'Company Name',
   	},
   	validation: {
   		enabled: true,
   	},
   };
   ```

6. `src/exporter/writer/IDXWriter.ts`

   ```ts
   import { create } from 'xmlbuilder2';
   import { CartesianPoint, EDMDDataSet } from '../../types/core';
   import { XMLBuilder, XMLWriterOptions } from 'xmlbuilder2/lib/interfaces';
   import { IDXWriteConfig } from '../../types/exporter/writer/idx-writer.interface';
   import { DefaultIDXWriteConfig } from './config/idx-writer.config';
   import { hasOwnProperty, iterateObject, toBoolean, toString } from '../../utils/object.utils';
   import { getIDXTagName, isIDXNameSpace, XsiTypeAttrName } from '../../core/utils/idx-namespace.utils';
   import { IDXComputationalTag, IDXD2Tag, IDXFoundationTag, IDXNameSpaceLinks, IDXPropertyTag, IDXXSITag } from '../../types/core/namespace.types';
   import { iterateArr } from '../../utils/array.utils';
   import { isValidNumber } from '../../utils/number.utils';
   
   /** IDX 格式生成器 */
   export class IDXWriter {
   	// ============= 状态量 =============
   
   	// ------------ 私有变量 ------------
   	/** 配置 */
   	private config = DefaultIDXWriteConfig;
   
   	// ------------ 序列化状态量 ------------
   	/** 数据集 */
   	private dataset: EDMDDataSet | undefined;
   	/** 文档根节点 */
   	private doc: XMLBuilder | undefined;
   	/** 数据集节点 */
   	private datasetEle: XMLBuilder | undefined;
   	/** 数据体节点 */
   	private bodyEle: XMLBuilder | undefined;
   
   	/** IDX 格式生成器 */
   	constructor(config?: IDXWriteConfig) {
   		if (config) {
   			this.config = config;
   		}
   	}
   
   	// ============= 序列化相关 =============
   	/** IDX格式序列化 */
   	serialize(dataset: EDMDDataSet): string {
   		// # IDX 初始化
   		if (!dataset) {
   			return '';
   		}
   		this.dataset = dataset;
   		this.createDoc();
   
   		// # 构建 IDX
   		this.building();
   
   		// # 序列化
   		const idxSource = this.createIDXSource();
   
   		// # 内存回收
   		this.memoryCycle();
   
   		return idxSource;
   	}
   
   	/** 内存回收 */
   	private memoryCycle() {
   		this.dataset = undefined;
   		this.doc = undefined;
   		this.datasetEle = undefined;
   		this.bodyEle = undefined;
   	}
   
   	/** 创建 IDX 文档 */
   	private createDoc() {
   		const doc = create({
   			version: '1.0',
   			encoding: 'utf-8',
   		});
   		this.doc = doc;
   	}
   
   	/** 构建 IDX */
   	private building() {
   		// # 构建 EDMDDataSet
   		this.buildEDMDDAtaSet();
   
   		// ## 构建 HEADER
   		this.buildHeader();
   
   		// ## 构建 Body
   		this.buildBody();
   
   		// ## 构建 ProcessInstruction
   		this.buildProcessInstruction();
   
   		// ## 构建历史记录
   		this.buildHistory();
   	}
   }
   ```
   
7. `src/exporter/writer/config/idx-writer.config.ts`

   ```ts
   import { IDXWriteConfig } from '../../../types/exporter/writer/idx-writer.interface';
   
   /** IDX 格式生成-默认配置 */
   export const DefaultIDXWriteConfig: IDXWriteConfig = {
   	enableComments: true,
   	formatting: {
   		prettyPrint: true,
   	},
   } as const;
   ```

### importer/

1. `src/importer/index.ts`

   ```ts
   // ============= IDX 导入器模块 =============

   import { IDXImporter } from './IDXImporter';

   export { IDXImporter };
   ```

2. `src/importer/IDXImporter.ts`

   ```ts
   export class IDXImporter {
   	// PLAN: 计划中...
   }
   ```

### types/

#### types/core/

1. `src/types/core/index.ts`

   ```ts
   // ============= IDX协议核心类型导出入口 =============
   // NOTE: 此文件导出所有核心类型，供其他模块使用

   // 导出枚举类型
   export * from './enums';

   // 导出基础类型
   export * from './base.types';

   // 导出几何类型
   export * from './geometry.types';

   // 导出形状元素类型
   export * from './shape-element.types';

   // 导出项目类型
   export * from './items.types';

   // 导出数据集类型
   export * from './dataset.types';

   // 导出命名空间类型
   export * from './namespace.types';
   ```

2. `src/types/core/base.types.ts`

   ```ts
   // ============= IDX协议核心基础类型 =============
   // DESIGN: 基础类型设计参考IDXv4.5规范第4-6章
   // NOTE: 所有IDX类型都扩展自EDMDObject，包含通用属性
   // REF: PSI5_IDXv4.5_Implementation_Guidelines.pdf Section 4

   import { StratumSurfaceDesignation, StratumType } from './enums';

   // ============= 通用基础接口 =============
   /**
    * IDX协议中所有对象的基接口
    *
    * @remarks
    * IDX规范中所有对象都包含id和可能的属性变更标记
    *
    * @example
    * ```typescript
    * // TEST_CASE: 创建基础对象
    * const obj: EDMDObject = {
    *   id: "ITEM_001",
    *   IsAttributeChanged: false
    * };
    * ```
    */
   export interface EDMDObject {
   	/** 对象唯一标识符，在上下文中必须唯一 */
   	id: string;
   	/** 标记对象属性是否已变更 */
   	IsAttributeChanged?: boolean;
   	/** 对象名称 */
   	Name?: string;
   	/** 对象描述 */
   	Description?: string;
   }

   // ============= 几何基础类型 =============
   /**
    * 二维笛卡尔坐标点
    *
    * @remarks
    * 用于描述PCB板上的位置，单位由GlobalUnitLength定义
    * REF: Section 7.1.10
    */
   export interface CartesianPoint extends EDMDObject {
   	/** X坐标值 */
   	X: number;
   	/** Y坐标值 */
   	Y: number;
   	/** Z坐标值(不常用) */
   	Z?: number;
   }

   /**
    * 长度属性值
    *
    * @remarks
    * IDX中所有长度值都应包装在此类型中，确保单位一致性
    * BUSINESS: 所有几何尺寸必须使用GlobalUnitLength指定的单位
    */
   export interface EDMDLengthProperty {
   	/** 数值 */
   	Value: number;
   	/** 单位，可选，默认为 Header 中的 GlobalUnitLength */
   	Unit?: GlobalUnit;
   }

   // ============= 标识符和引用类型 =============
   /**
    * 系统范围内唯一标识符
    *
    * @remarks
    * IDX使用五元组标识符确保在协作过程中的唯一性
    * REF: Section 5.2.1
    */
   export interface EDMDIdentifier {
   	/** 创建该标识符的系统范围 */
   	SystemScope: string;
   	/** 标识符编号 */
   	Number: string;
   	/** 版本号，通常从1开始 */
   	Version: number;
   	/** 修订号 */
   	Revision: number;
   	/** 序列号，每次变更递增 */
   	Sequence: number;
   }

   /**
    * 对象名称，用于跨系统引用
    *
    * @remarks
    * 包含系统范围和对象名称，确保在协作中正确引用
    */
   export interface EDMName {
   	SystemScope: string;
   	ObjectName: string;
   }

   // ============= 用户属性类型 =============
   /**
    * 用户自定义简单属性
    *
    * @remarks
    * 用于存储ECAD/MCAD系统的特定属性
    * 使用正确的类型名称 property:EDMDUserSimpleProperty
    * TEST_CASE: 添加组件参数属性
    * TEST_EXPECT: 正确序列化为XML属性
    */
   export interface EDMDUserSimpleProperty {
   	Key: EDMName;
   	Value: string | number | boolean;
   	IsChanged?: boolean;
   	IsNew?: boolean;
   	Persistent?: boolean;
   	IsOriginator?: boolean;
   }

   // ============= 变换矩阵类型 =============
   /**
    * 2D变换矩阵
    *
    * @remarks
    * 用于描述2D空间中的平移、旋转和缩放
    * 移除 xsi:type，使用 TransformationType 元素
    * 平移分量使用 { Value: number } 格式
    * REF: Section 4.1.1.1
    * DESIGN: 使用标准变换矩阵表示，与3D图形系统兼容
    */
   export interface EDMDTransformation2D {
   	/** 变换类型标识 */
   	TransformationType: 'd2';

   	// 旋转分量
   	xx: number; // cosθ
   	xy: number; // -sinθ
   	yx: number; // sinθ
   	yy: number; // cosθ

   	// 平移分量（使用 foundation:Value 包装）
   	tx: number;
   	ty: number;

   	// 可选Z偏移，用于相对层定位
   	zOffset?: number;
   }

   /**
    * 3D变换矩阵
    *
    * @remarks
    * 完整3D变换，用于绝对定位
    * 平移分量使用 { Value: number } 格式
    * PERFORMANCE: 3D变换在大多数IDX实现中较少使用
    */
   export interface EDMDTransformation3D {
   	/** 变换类型标识 */
   	TransformationType: 'd3';

   	// 旋转分量
   	xx: number;
   	xy: number;
   	xz: number;
   	yx: number;
   	yy: number;
   	yz: number;
   	zx: number;
   	zy: number;
   	zz: number;

   	// 平移分量（使用 foundation:Value 包装）
   	tx: number;
   	ty: number;
   	tz: number;
   }

   export type EDMDTransformation = EDMDTransformation2D | EDMDTransformation3D;

   // ============= 全局单位和头部信息 =============
   /**
    * 全局单位定义
    *
    * @remarks
    * IDX文件必须指定全局长度单位，确保所有系统使用一致的单位
    * BUSINESS: 大多数PCB设计使用毫米(mm)作为单位
    */
   export enum GlobalUnit {
   	UNIT_MM = 'UNIT_MM',
   	UNIT_INCH = 'UNIT_INCH',
   	UNIT_MIL = 'UNIT_MIL',
   	UNIT_CM = 'UNIT_CM',
   }

   /**
    * EDMD数据集头部信息
    *
    * @remarks
    * 包含创建者信息、时间戳和全局设置
    * REF: Section 5.1
    */
   export interface EDMDHeader {
   	/** 数据集描述 */
   	Description?: string;
   	/** 创建者姓名 */
   	CreatorName?: string;
   	/** 创建者公司 */
   	CreatorCompany?: string;
   	/** 创建者系统（ECAD/MCAD软件名称） */
   	CreatorSystem?: string;
   	/** 后处理器名称 */
   	PostProcessor?: string;
   	/** 后处理器版本 */
   	PostProcessorVersion?: string;
   	/** 创建者用户ID */
   	Creator?: string;
   	/** 全局长度单位 */
   	GlobalUnitLength: GlobalUnit;
   	/** 创建日期时间 (ISO 8601) */
   	CreationDateTime: string;
   	/** 最后修改日期时间 (ISO 8601) */
   	ModifiedDateTime: string;
   }

   /**
    * 角色和所有权信息
    *
    * @remarks
    * 用于标记项目的协作权限（机械/电气）
    * REF: Section 4.1.3
    */
   export interface RoleOnItemInstance {
   	RoleName: EDMName;
   	RoleType: 'owner' | 'reviewer' | 'designer';
   	Category: 'Mechanical' | 'Electrical' | 'Both';
   	Function: 'Design' | 'Review' | 'Manufacturing';
   	Context: string; // 引用的ItemInstance ID
   }

   // ============= 层技术定义 =============

   /**
    * 层技术类型
    *
    * @remarks
    * 定义层的技术特性
    * REF: Section 6.1.2.3
    */
   export interface EDMDStratumTechnology extends EDMDObject {
   	/** 技术类型：Design 或 Documentation */
   	TechnologyType: 'Design' | 'Documentation';
   	/** 层用途 */
   	LayerPurpose:
   		| 'OtherSignal'
   		| 'PowerOrGround'
   		| 'SolderMask'
   		| 'SilkScreen'
   		| 'LandsOnly'
   		| 'SolderPaste'
   		| 'PasteMask'
   		| 'Dielectric';
   }
   ```

3. `src/types/core/dataset.types.ts`

   ```ts
   import { EDMDIdentifier, EDMDObject, EDMName, EDMDTransformation, EDMDHeader, CartesianPoint, EDMDStratumTechnology } from './base.types';
   import { EDMDGeometry, EDMDCurveSet2D } from './geometry.types';
   import { EDMDItemSingle, EDMDItemAssembly } from './items.types';
   import { EDMDShapeElement, EDMDStratum } from './shape-element.types';
   
   // ============= IDX消息类型 =============
   // DESIGN: IDX协议支持三种消息类型，所有消息都基于EDMDDataSet
   // REF: Section 3, 5.1-5.5
   // NOTE: 消息类型决定了数据集的用途和解释方式
   
   /**
    * 处理指令类型
    *
    * @remarks
    * 定义IDX消息的类型和行为
    * REF: Section 5.1, 5.2
    */
   export type EDMDProcessInstruction =
   	| EDMDProcessInstructionSendInformation
   	| EDMDProcessInstructionSendChanges
   	| EDMDProcessInstructionRequestForInformation;
   
   /**
    * 发送信息指令（基线发送）
    *
    * @remarks
    * 用于发送初始基线或重新基线
    * REF: Section 5.1
    */
   export interface EDMDProcessInstructionSendInformation {
   	/** 执行者（发送者） */
   	Actor?: string;
   	/** 指令描述 */
   	Description?: string;
   }
   
   /**
    * 发送变更指令（变更提议或响应）
    *
    * @remarks
    * 用于发送设计变更或响应变更
    * REF: Section 5.2
    */
   export interface EDMDProcessInstructionSendChanges {
   	/** 执行者 */
   	Actor?: string;
   	/** 变更列表 */
   	Changes?: EDMDTransaction[];
   }
   
   /**
    * 请求信息指令
    *
    * @remarks
    * 用于请求项目状态信息，当前较少使用
    * REF: Section 3 Introduction
    */
   export interface EDMDProcessInstructionRequestForInformation {
   	/** 执行者 */
   	Actor?: string;
   	/** 请求的项目标识符 */
   	RequestedItems?: EDMDIdentifier[];
   }
   
   /**
    * 事务变更记录
    *
    * @remarks
    * 记录一个或多个设计变更
    * REF: Section 5.2.1
    */
   export interface EDMDTransaction extends EDMDObject {
   	/** 变更列表 */
   	Changes: EDMDChange[];
   	/** 事务描述 */
   	Description?: string;
   }
   
   /**
    * 单个变更定义
    *
    * @remarks
    * 描述一个具体的项目变更
    */
   export interface EDMDChange {
   	/** 执行者 */
   	Actor?: string;
   	/** 新项目标识符 */
   	NewItem?: EDMDIdentifier;
   	/** 前驱项目标识符 */
   	PredecessorItem?: EDMDIdentifier;
   	/** 接受标记（用于响应） */
   	Accept?: { Value: boolean };
   	/** 删除的实例名称（用于删除操作） */
   	DeletedInstanceName?: EDMName;
   }
   
   /**
    * 3D模型引用
    *
    * @remarks
    * 用于引用外部3D模型文件
    * REF: Section 6.2.1.3
    */
   export interface EDMDModel3D extends EDMDObject {
   	/** 模型标识符（文件名或ID） */
   	ModelIdentifier: string;
   	/** 模型版本/配置 */
   	ModelVersion?: string;
   	/** 模型位置（相对路径） */
   	ModelLocation?: string;
   	/** MCAD文件格式 */
   	MCADFormat: 'SolidWorks' | 'NX' | 'Catia' | 'STEP' | 'STL' | 'Inventor' | 'Fusion' | 'SolidEdge';
   	/** MCAD格式版本 */
   	MCADFormatVersion?: string;
   	/** 变换矩阵（用于对齐） */
   	Transformation?: EDMDTransformation;
   	/** 变换参考（坐标系名称） */
   	TransformationReference?: string;
   }
   
   /**
    * 历史记录
    *
    * @remarks
    * 可选的事务历史记录
    * REF: Section 5.4
    */
   export interface EDMDHistory extends EDMDObject {
   	/** 历史记录条目 */
   	HistoryEntries?: EDMDHistoryEntry[];
   	/** 主题（引用的事务或变更） */
   	Subject?: string;
   }
   
   /**
    * 历史记录条目
    */
   export interface EDMDHistoryEntry {
   	/** 创建者标识符 */
   	Creator: string;
   	/** 文本描述 */
   	Text: string;
   	/** 创建日期时间 */
   	CreationDateTime: string;
   	/** 系统范围 */
   	SystemScope: string;
   }
   
   /**
    * EDMD数据集根元素
    *
    * @remarks
    * IDX文件的根元素，包含头部、数据体和处理指令
    * REF: Section 4
    * XML: <foundation:EDMDDataSet>
    */
   export interface EDMDDataSet {
   	/** 头部信息 */
   	Header: EDMDHeader;
   	/** 数据体，包含所有设计数据 */
   	Body: {
   		/** 点集合 */
   		Points?: CartesianPoint[];
   		/** 几何元素集合 */
   		Geometries?: EDMDGeometry[];
   		/** 2D曲线集合 */
   		CurveSets?: EDMDCurveSet2D[];
   		/** 形状元素集合 */
   		ShapeElements?: EDMDShapeElement[];
   		/** 层技术定义集合 */
   		StratumTechnologies?: EDMDStratumTechnology[];
   		/** 层定义集合（传统方式） */
   		Strata?: EDMDStratum[];
   		/** 3D模型引用集合 */
   		Models3D?: EDMDModel3D[];
   		/** 项目定义集合（Item single） */
   		ItemsSingle?: EDMDItemSingle[];
   		/** 项目实例集合（Item assembly） */
   		ItemsAssembly?: EDMDItemAssembly[];
   		/** 历史记录（可选） */
   		History?: EDMDHistory[];
   	};
   	/** 处理指令 */
   	ProcessInstruction: EDMDProcessInstruction;
   }
   ```
4. `src/types/core/enums.ts`

   ```ts
   // ============= IDX协议核心枚举类型 =============
   // NOTE: 所有枚举值必须与IDXv4.5规范完全一致
   // REF: PSI5_IDXv4.5_Implementation_Guidelines.pdf Tables 2-11
   
   // ------------ 项目类型枚举 ------------
   /**
    * 项目类型枚举
    *
    * @remarks
    * 定义EDMDItem的ItemType属性，标识项目是单个还是装配体
    * REF: Section 4.1
    */
   export enum ItemType {
   	/** 简单类型-项目定义 */
   	SINGLE = 'single',
   	/** 复杂类型-项目实例 */
   	ASSEMBLY = 'assembly',
   }
   
   /**
    * 几何类型枚举
    *
    * @remarks
    * IDXv4.0+引入的简化方式的关键属性，直接标识项目的类型和功能
    * 替代传统方式中的"Third Item"对象，减少XML嵌套和文件大小
    * REF: Section 6.1 (Table 8), Section 6.9 (Table 8)
    */
   export enum GeometryType {
   	// ------------ 板相关 ------------
   	/** 板轮廓：定义PCB板的外形轮廓和厚度 */
   	BOARD_OUTLINE = 'BOARD_OUTLINE',
   	/** 柔性板区域：定义柔性电路板的可弯曲区域 */
   	BOARD_AREA_FLEXIBLE = 'BOARD_AREA_FLEXIBLE',
   	/** 刚性板区域：定义PCB中的刚性支撑区域 */
   	BOARD_AREA_RIGID = 'BOARD_AREA_RIGID',
   	/** 加强板区域：定义用于增加刚性的加强区域 */
   	BOARD_AREA_STIFFENER = 'BOARD_AREA_STIFFENER',
   
   	// ------------ 组件相关 ------------
   	/** 电气元件：标准电气元件（电阻、电容、IC等） */
   	COMPONENT = 'COMPONENT',
   	/** 机械元件：非电气元件（散热器、安装支架等） */
   	COMPONENT_MECHANICAL = 'COMPONENT_MECHANICAL',
   
   	// ------------ 孔相关 ------------
   	/** 电镀孔：具有导电镀层的通孔（PTH） */
   	HOLE_PLATED = 'HOLE_PLATED',
   	/** 非电镀孔：无导电镀层的机械孔（NPTH） */
   	HOLE_NON_PLATED = 'HOLE_NON_PLATED',
   	/** 电镀铣削切口：通过铣削工艺形成的电镀切口 */
   	HOLE_PLATED_MILLED = 'HOLE_PLATED_MILLED',
   	/** 非电镀铣削切口：通过铣削工艺形成的非电镀切口 */
   	HOLE_NONPLATED_MILLED = 'HOLE_NONPLATED_MILLED',
   	/** 过孔：用于连接不同信号层的镀铜孔 */
   	VIA = 'VIA',
   	/** 填充过孔：内部填充材料（树脂/铜）的过孔 */
   	FILLED_VIA = 'FILLED_VIA',
   
   	// ------------ 禁止区域相关 ------------
   	/** 布线禁布区：禁止布线的区域 */
   	KEEPOUT_AREA_ROUTE = 'KEEPOUT_AREA_ROUTE',
   	/** 元件禁布区：禁止放置元件的区域 */
   	KEEPOUT_AREA_COMPONENT = 'KEEPOUT_AREA_COMPONENT',
   	/** 过孔禁布区：禁止放置过孔的区域 */
   	KEEPOUT_AREA_VIA = 'KEEPOUT_AREA_VIA',
   	/** 测试点禁布区：禁止放置测试点的区域 */
   	KEEPOUT_AREA_TESTPOINT = 'KEEPOUT_AREA_TESTPOINT',
   	/** 热禁布区：因热考虑需要保持空旷的区域 */
   	KEEPOUT_AREA_THERMAL = 'KEEPOUT_AREA_THERMAL',
   	/** 其他禁布区：未分类的其他类型禁布区域 */
   	KEEPOUT_AREA_OTHER = 'KEEPOUT_AREA_OTHER',
   
   	// ------------ 保持区域相关 ------------
   	/** 布线保持区：必须布线的区域（保持布线） */
   	KEEPIN_AREA_ROUTE = 'KEEPIN_AREA_ROUTE',
   	/** 元件保持区：必须放置元件的区域 */
   	KEEPIN_AREA_COMPONENT = 'KEEPIN_AREA_COMPONENT',
   	/** 过孔保持区：必须放置过孔的区域 */
   	KEEPIN_AREA_VIA = 'KEEPIN_AREA_VIA',
   	/** 测试点保持区：必须放置测试点的区域 */
   	KEEPIN_AREA_TESTPOINT = 'KEEPIN_AREA_TESTPOINT',
   	/** 热保持区：因热考虑需要填充的区域 */
   	KEEPIN_AREA_THERMAL = 'KEEPIN_AREA_THERMAL',
   	/** 其他保持区：未分类的其他类型保持区域 */
   	KEEPIN_AREA_OTHER = 'KEEPIN_AREA_OTHER',
   
   	// ------------ 布局区域 ------------
   	/** 放置组区域：逻辑上相关的元件分组区域（不强制放置） */
   	PLACEMENT_GROUP_AREA = 'PLACEMENT_GROUP_AREA',
   	/** 其他轮廓/用户区域：用户自定义的未分类区域（如logo位置等） */
   	OTHER_OUTLINE = 'OTHER_OUTLINE',
   
   	// ------------ 层相关 ------------
   	/** 阻焊层：用于防止焊锡粘附的绝缘层 */
   	LAYER_SOLDERMASK = 'LAYER_SOLDERMASK',
   	/** 焊膏层：用于SMT焊接的锡膏印刷层 */
   	LAYER_SOLDERPASTE = 'LAYER_SOLDERPASTE',
   	/** 丝印层：用于印刷标识和符号的油墨层 */
   	LAYER_SILKSCREEN = 'LAYER_SILKSCREEN',
   	/** 通用层：未指定具体用途的通用层 */
   	LAYER_GENERIC = 'LAYER_GENERIC',
   	/** 胶层：用于固定元件的粘合剂层 */
   	LAYER_GLUE = 'LAYER_GLUE',
   	/** 胶掩膜层：定义胶层应用区域的掩膜 */
   	LAYER_GLUEMASK = 'LAYER_GLUEMASK',
   	/** 焊膏掩膜层：定义焊膏应用区域的掩膜 */
   	LAYER_PASTEMASK = 'LAYER_PASTEMASK',
   	/** 其他信号层：常规信号走线层 */
   	LAYER_OTHERSIGNAL = 'LAYER_OTHERSIGNAL',
   	/** 仅焊盘层：只包含焊盘连接点的层 */
   	LAYER_LANDSONLY = 'LAYER_LANDSONLY',
   	/** 电源/地层：用于电源分配和接地的层 */
   	LAYER_POWERGROUND = 'LAYER_POWERGROUND',
   	/** 嵌入式电容介质层：用于嵌入式电容的介质材料层 */
   	LAYER_EMBEDDED_CAP_DIELECTRIC = 'LAYER_EMBEDDED_CAP_DIELECTRIC',
   	/** 嵌入式电阻层：用于嵌入式电阻的材料层 */
   	LAYER_EMBEDDED_RESISTOR = 'LAYER_EMBEDDED_RESISTOR',
   	/** 介质层：绝缘隔离材料层（FR4等） */
   	LAYER_DIELECTRIC = 'LAYER_DIELECTRIC',
   	/** 层堆叠定义：多个物理层的堆叠顺序定义 */
   	LAYER_STACKUP = 'LAYER_STACKUP',
   	/** 通用层定义：未指定类型的通用层（兼容性） */
   	LAYER = 'LAYER',
   
   	// ------------ 弯曲区域 ------------
   	/** 弯曲区域：定义柔性板的弯曲位置和参数 */
   	BEND = 'BEND',
   
   	// ------------ 铜相关 ------------
   	/** 铜焊盘：元件引脚的铜连接区域 */
   	COPPER_PAD = 'COPPER_PAD',
   	/** 铜走线：信号连接的铜线条 */
   	COPPER_TRACE = 'COPPER_TRACE',
   	/** 铜皮区域：大面积的铜填充区域（用于接地/电源） */
   	COPPER_AREA = 'COPPER_AREA',
   }
   
   // ------------ 层和地层相关枚举 ------------
   /**
    * 地层类型枚举
    *
    * @remarks
    * 定义PCB板的层类型
    * REF: Section 6.1.2
    */
   export enum StratumType {
   	/** 设计层（物理层） */
   	DesignLayerStratum = 'DesignLayerStratum',
   	/** 文档层（非物理层） */
   	DocumentationLayerStratum = 'DocumentationLayerStratum',
   }
   
   /**
    * 地层表面指定枚举
    *
    * @remarks
    * 定义层在板中的位置
    */
   export enum StratumSurfaceDesignation {
   	/** 主表面（通常为板顶面或底面） */
   	PrimarySurface = 'PrimarySurface',
   	/** 次表面 */
   	SecondarySurface = 'SecondarySurface',
   }
   
   /**
    * 层目的枚举
    *
    * @remarks
    * 定义PCB层的功能和用途
    * REF: Section 6.1.2, Table 4
    */
   export enum LayerPurpose {
   	SOLDERMASK = 'SolderMask',
   	SOLDERPASTE = 'SolderPaste',
   	SILKSCREEN = 'SilkScreen',
   	GENERIC = 'GenericLayer',
   	GLUE = 'Glue',
   	GLUEMASK = 'GlueMask',
   	PASTEMASK = 'PasteMask',
   	OTHERSIGNAL = 'OtherSignal',
   	LANDSONLY = 'LandsOnly',
   	POWERGROUND = 'PowerOrGround',
   	EMBEDDED_CAP_DIELECTRIC = 'EmbeddedPassiveCapacitorDielectric',
   	EMBEDDED_RESISTOR = 'EmbeddedPassiveResistor',
   	DIELECTRIC = 'Dielectric',
   }
   
   // ------------ 保持区域约束目的枚举 ------------
   /**
    * 保持区域约束目的枚举
    *
    * @remarks
    * 定义保持区域的功能和限制类型
    * REF: Section 6.5, Tables 6-7
    */
   export enum KeepConstraintPurpose {
   	ROUTE = 'Route',
   	COMPONENT_PLACEMENT = 'ComponentPlacement',
   	VIA = 'Via',
   	TEST_POINT = 'TestPoint',
   	THERMAL = 'Thermal',
   	GENERIC_CLEARANCE = 'GenericClearance',
   	SHOCK = 'Shock',
   	VIBRATION = 'Vibration',
   	ELECTROMAGNETIC_COMPATIBILITY = 'ElectromagneticCompatibility',
   	VALUE_LIMIT = 'ValueLimit',
   	PLANE = 'Plane',
   	OTHER = 'Other',
   }
   
   // ------------ 层间特征类型枚举 ------------
   /**
    * 层间特征类型枚举
    *
    * @remarks
    * 定义跨越多层的特征类型，如孔、过孔等
    * REF: Section 6.3, Table 5
    */
   export enum InterStratumFeatureType {
   	CUTOUT = 'Cutout',
   	PLATED_CUTOUT = 'PlatedCutout',
   	MILLED_CUTOUT = 'MilledCutout',
   	PARTIALLY_PLATED_CUTOUT = 'PartiallyPlatedCutout',
   	VIA = 'Via',
   	FILLED_VIA = 'FilledVia',
   	PLATED_PASSAGE = 'PlatedPassage',
   	UNSUPPORTED_PASSAGE = 'UnsupportedPassage',
   }
   
   // ------------ 装配组件类型枚举 ------------
   /**
    * 装配组件类型枚举
    *
    * @remarks
    * 定义组件类型（电气/机械）
    * REF: Section 6.2
    */
   export enum AssemblyComponentType {
   	PHYSICAL = 'Physical',
   	MECHANICAL_ITEM = 'MechanicalItem',
   	ASSEMBLY_GROUP_COMPONENT = 'AssemblyGroupComponent',
   	LAMINATE_COMPONENT = 'LaminateComponent',
   	THERMAL_COMPONENT = 'ThermalComponent',
   	PADSTACK = 'Padstack',
   }
   
   // ------------ 形状元素类型枚举 ------------
   /**
    * 形状元素类型枚举
    *
    * @remarks
    * 定义形状元素的功能和用途
    * REF: Section 6.9 (Table 8)
    */
   export enum ShapeElementType {
   	/** 特征形状元素（最常用） */
   	FeatureShapeElement = 'FeatureShapeElement',
   	/** 零件安装特征（用于孔、铣削切口等） */
   	PartMountingFeature = 'PartMountingFeature',
   	/** 非特征形状元素（用于弯曲区域等） */
   	NonFeatureShapeElement = 'NonFeatureShapeElement',
   	/** 零件特征 */
   	PartFeature = 'PartFeature',
   	/** 元件端子（用于引脚定义） */
   	ComponentTermination = 'ComponentTermination',
   	/** 设计层 */
   	DesignLayerStratum = 'DesignLayerStratum',
   }
   
   // ------------ 功能形状类型枚举 ------------
   /**
    * 功能形状类型枚举
    *
    * @remarks
    * 定义特殊功能形状的类型
    * REF: Section 6.1.2.3
    */
   export enum FunctionalItemShapeType {
   	FLEXIBLE_AREA = 'FlexibleArea',
   	RIGID_AREA = 'RigidArea',
   	STIFFENER = 'Stiffener',
   	PLACEMENT_GROUP_AREA = 'PlacementGroupArea',
   	USER_AREA = 'UserArea',
   	MECHANICAL_ITEM = 'MechanicalItem',
   }
   
   // ------------ 技术类型枚举 ------------
   /**
    * 技术类型枚举
    *
    * @remarks
    * 定义层技术类型（设计/文档）
    * REF: Section 6.8
    */
   export enum TechnologyType {
   	DESIGN = 'Design',
   	DOCUMENTATION = 'Documentation',
   }
   
   // ------------ 弯曲类型相关枚举 ------------
   /**
    * 弯曲侧面枚举
    *
    * @remarks
    * 定义弯曲的内侧或外侧
    * REF: Section 6.1.2.4
    */
   export enum BendSide {
   	TOP = 'Top',
   	BOTTOM = 'Bottom',
   }
   
   /**
    * 弯曲类型枚举
    *
    * @remarks
    * 目前仅支持圆形弯曲
    */
   export enum BendTypeEnum {
   	CIRCULAR_BEND = 'CircularBend',
   }
   ```
5. `src/types/core/geometry.types.ts`

   ```ts
   // ============= 几何形状类型定义 =============
   // DESIGN: IDX使用2.5D几何表示法（2D轮廓+高度范围）
   // REF: Section 7.1
   // NOTE: 所有几何类型都遵循"translation body"概念

   import { EDMDObject, EDMDLengthProperty, EDMDUserSimpleProperty, EDMDTransformation } from './base.types';

   // ============= 几何描述类型 =============
   /**
    * 多段线几何元素
    *
    * @remarks
    * 由一系列点连接而成的折线，可闭合
    * REF: Section 7.1.7
    * XML: <foundation:PolyLine xsi:type="d2:EDMDPolyLine">
    */
   export interface EDMDPolyLine extends EDMDObject {
   	/** 点序列，引用 CartesianPoint 的 id */
   	Points: string[];
   	/** 可选厚度，用于表示走线或铣削路径的宽度 */
   	Thickness?: EDMDLengthProperty;
   	/** XML 类型声明 */
   	'@type'?: 'd2:EDMDPolyLine';
   }

   /**
    * 圆弧几何元素
    *
    * @remarks
    * 由起点、中间点和终点定义的圆弧
    * REF: Section 7.1.1
    */
   export interface EDMDArc extends EDMDObject {
   	/** 起点，引用 CartesianPoint 的 id */
   	StartPoint: string;
   	/** 中间点，引用 CartesianPoint 的 id */
   	MidPoint: string;
   	/** 终点，引用 CartesianPoint 的 id */
   	EndPoint: string;
   	/** XML 类型声明 */
   	'@type'?: 'd2:EDMDArc';
   }

   /**
    * 圆心式圆几何元素
    *
    * @remarks
    * 由圆心点和直径定义的圆
    * REF: Section 7.1.4
    */
   export interface EDMDCircleCenter extends EDMDObject {
   	/** 圆心点，引用 CartesianPoint 的 id */
   	CenterPoint: string;
   	/** 直径 */
   	Diameter: EDMDLengthProperty;
   }

   /**
    * 三点式圆几何元素
    *
    * @remarks
    * 由三个点定义的圆
    * REF: Section 7.1.3
    */
   export interface EDMDCircle3Point extends EDMDObject {
   	/** 点1，引用 CartesianPoint 的 id */
   	Point1: string;
   	/** 点2，引用 CartesianPoint 的 id */
   	Point2: string;
   	/** 点3，引用 CartesianPoint 的 id */
   	Point3: string;
   }

   /**
    * 椭圆几何元素
    *
    * @remarks
    * 由中心点和长短半轴定义的椭圆
    * REF: Section 7.1.5
    */
   export interface EDMDEllipse extends EDMDObject {
   	/** 中心点，引用 CartesianPoint 的 id */
   	CenterPoint: string;
   	/** 长半轴长度 */
   	SemiMajorAxis: EDMDLengthProperty;
   	/** 短半轴长度 */
   	SemiMinorAxis: EDMDLengthProperty;
   }

   /**
    * B样条曲线几何元素
    *
    * @remarks
    * 参数化曲线，通过控制点、阶数和节点向量定义
    * REF: Section 7.1.2
    */
   export interface EDMDBSplineCurve extends EDMDObject {
   	/** 控制点序列，引用 CartesianPoint 的 id */
   	ControlPoints: string[];
   	/** 曲线阶数 */
   	Degree: number;
   	/** 是否闭合曲线 */
   	ClosedCurve?: boolean;
   	/** 是否自相交 */
   	SelfIntersect?: boolean;
   	/** 曲线形式 */
   	CurveForm?: string;
   }

   /**
    * 复合曲线几何元素
    *
    * @remarks
    * 由多条曲线组合而成的复杂曲线
    * REF: Section 7.1.8
    */
   export interface EDMDCompositeCurve extends EDMDObject {
   	/** 组成曲线的元素，引用其他几何元素的 id */
   	Curves: string[];
   }

   /**
    * 直线几何元素
    *
    * @remarks
    * 由点和向量定义的无限长直线
    * REF: Section 6.1.2.4 (Bend Line)
    */
   export interface EDMDLine extends EDMDObject {
   	/** 起点，引用 CartesianPoint 的 id */
   	Point: string;
   	/** 方向向量，引用 CartesianPoint 的 id */
   	Vector: string;
   }

   /**
    * 几何元素联合类型
    */
   export type EDMDGeometry =
   	| EDMDPolyLine
   	| EDMDArc
   	| EDMDCircleCenter
   	| EDMDCircle3Point
   	| EDMDEllipse
   	| EDMDBSplineCurve
   	| EDMDCompositeCurve
   	| EDMDLine;

   // ============= 2D曲线集 =============

   /**
    * 2D曲线集合
    *
    * @remarks
    * 定义几何元素的Z轴范围，实现2.5D表示
    * REF: Section 7.1
    * XML: <foundation:CurveSet2d xsi:type="d2:EDMDCurveSet2d">
    */
   export interface EDMDCurveSet2D extends EDMDObject {
   	/** 形状描述类型，通常为 GeometricModel */
   	ShapeDescriptionType: 'GeometricModel' | 'DocumentationModel';
   	/** Z轴下边界，定义曲线起始高度 */
   	LowerBound: EDMDLengthProperty;
   	/** Z轴上边界，定义曲线结束高度 */
   	UpperBound: EDMDLengthProperty;
   	/** 引用的几何元素id列表 */
   	DetailedGeometricModelElements: string[];
   }
   ```

6. `src/types/core/items.types.ts`

   ```ts
   // ============= 项目和相关类型 =============
   // DESIGN: EDMDItem是IDX协作的核心概念，代表任何可协作对象
   // REF: Section 4.1
   // NOTE: 项目可以是单个组件或装配体（包含多个子项目）

   import {
   	EDMDObject,
   	EDMName,
   	EDMDTransformation,
   	EDMDLengthProperty,
   	EDMDUserSimpleProperty,
   	EDMDIdentifier,
   	CartesianPoint,
   	RoleOnItemInstance,
   } from './base.types';
   import { GeometryType } from './enums';

   // ============= 项目定义 (Item single) =============

   /**
    * 项目定义（ItemType="single"）
    *
    * @remarks
    * 表示项目的几何定义，可被多个实例引用
    * REF: Section 4.1
    * XML: <foundation:Item>
    */
   export interface EDMDItemSingle extends EDMDObject {
   	/** 项目类型，必须为 "single" */
   	ItemType: 'single';
   	/** 项目唯一标识符 */
   	Identifier?: EDMDIdentifier;
   	/** 包名称（用于可重用封装，如元件封装） */
   	PackageName?: EDMName;
   	/** 形状引用：在简化方式中引用 ShapeElement，传统方式中引用 Stratum 等 */
   	Shape: string;
   	/** 包引脚定义（用于元件引脚位置） */
   	PackagePins?: EDMPackagePin[];
   	/** 3D模型引用（可选） */
   	EDMD3DModel?: string;
   	/** 基线标记 */
   	BaseLine?: { Value: boolean };
   	/** 用户自定义属性 */
   	UserProperties?: EDMDUserSimpleProperty[];
   }

   /**
    * 包引脚定义
    *
    * @remarks
    * 用于定义元件引脚的位置和形状
    * REF: Section 6.2.1.5
    */
   export interface EDMPackagePin {
   	/** 引脚编号 */
   	pinNumber: string;
   	/** 是否为主引脚（引脚1） */
   	primary: boolean;
   	/** 引脚位置点，引用 CartesianPoint 的 id */
   	Point: string;
   	/** 引脚形状引用 */
   	Shape?: string;
   }

   // ============= 项目实例 (Item assembly) =============

   /**
    * 项目实例定义
    *
    * @remarks
    * 表示项目定义的一个具体实例，包含位置和变换信息
    * REF: Section 4.1.1.1
    */
   export interface EDMDItemInstance extends EDMDObject {
   	/** 引用的项目定义（Item single）id */
   	Item: string;
   	/** 实例名称 */
   	InstanceName: EDMName;
   	/** 变换矩阵 */
   	Transformation?: EDMDTransformation;
   	/** Z轴偏移（相对定位，IDXv4.0+） */
   	zOffset?: EDMDLengthProperty;
   	/** 弯曲序列号（用于柔性板弯曲顺序） */
   	bendSequenceNumber?: number;
   	/** 用户自定义属性 */
   	UserProperties?: EDMDUserSimpleProperty[];
   	/** 实例用户区域层名称（用于Other Outline映射到ECAD层） */
   	InstanceUserAreaLayerName?: EDMName;
   }

   /**
    * 项目实例集合（ItemType="assembly"）
    *
    * @remarks
    * 表示项目的一个或多个实例，包含几何类型和实例列表
    * REF: Section 4.1
    */
   export interface EDMDItemAssembly extends EDMDObject {
   	/** 项目类型，必须为 "assembly" */
   	ItemType: 'assembly';
   	/** 几何类型（简化方式的关键属性） */
   	geometryType?: GeometryType;
   	/** 项目唯一标识符 */
   	Identifier?: EDMDIdentifier;
   	/** 项目实例列表 */
   	ItemInstances: EDMDItemInstance[];
   	/** 装配到名称（用于相对层/表面定位） */
   	AssembleToName?: string;
   	/** 参考名称（便于其他项目引用） */
   	ReferenceName?: string;
   	/** 基线标记 */
   	BaseLine?: { Value: boolean };
   	/** 用户自定义属性 */
   	UserProperties?: EDMDUserSimpleProperty[];
   	/** 角色和权限信息 */
   	Roles?: RoleOnItemInstance[];
   }
   ```

7. `src/types/core/namespace.types.ts`

   ```ts
   /** IDX 命名空间 */
   export enum IDXNameSpace {
   	/**
   	 * 基础数据结构命名空间
   	 * 包含核心元素: EDMDDataSet, Header, Body, Item, ShapeElement 等
   	 */
   	Foundation = 'foundation',
   	/**
   	 * 产品数据管理命名空间
   	 * 包含: ItemType, Identifier, Transformation, Stratum, AssemblyComponent 等
   	 */
   	PDM = 'pdm',
   	/**
   	 * 2D几何命名空间
   	 * 包含: CartesianPoint, PolyLine, CurveSet2d, Arc, Circle, Ellipse 等
   	 */
   	D2 = 'd2',
   	/**
   	 * 属性定义命名空间
   	 * 包含: EDMDUserSimpleProperty, EDMDLengthProperty 等
   	 */
   	Property = 'property',
   	/**
   	 * 计算与处理指令命名空间
   	 * 包含: EDMDProcessInstructionSendInformation, EDMDProcessInstructionSendChanges 等
   	 */
   	Computational = 'computational',
   	/**
   	 * 管理与权限命名空间
   	 * 包含: RoleOnItemInstance, User 等权限管理元素
   	 */
   	Administration = 'administration',
   	/**
   	 * XML Schema 实例命名空间
   	 * 用于 XML Schema 验证，标准 XML 命名空间，非 IDX 专有
   	 * 包含: type, schemaLocation 等属性
   	 */
   	XSI = 'xsi',
   }

   /**
    * IDX 命名空间 URI 映射表
    *
    * 映射每个命名空间前缀到其标准 URI。
    * 这些 URI 是固定的，由 prostep ivip 协会定义。
    */
   export const IDXNameSpaceLinks: Record<IDXNameSpace, string> = {
   	[IDXNameSpace.Foundation]: 'http://www.prostep.org/EDMD/Foundation',
   	[IDXNameSpace.PDM]: 'http://www.prostep.org/EDMD/PDM',
   	[IDXNameSpace.D2]: 'http://www.prostep.org/EDMD/2D',
   	[IDXNameSpace.Property]: 'http://www.prostep.org/EDMD/Property',
   	[IDXNameSpace.Computational]: 'http://www.prostep.org/EDMD/Computational',
   	[IDXNameSpace.Administration]: 'http://www.prostep.org/EDMD/Administration',
   	[IDXNameSpace.XSI]: 'http://www.w3.org/2001/XMLSchema-instance',
   } as const;

   /**
    * IDX-Foundation-命名空间标签枚举
    * 包含核心数据结构元素，位于 foundation 命名空间
    */
   export enum IDXFoundationTag {
   	/** 数据集根元素，包含 Header、Body 和 ProcessInstruction 三个主要部分 */
   	EDMDDataSet = 'EDMDDataSet',
   	/** 头部信息，包含创建者、时间戳、单位等元数据 */
   	Header = 'Header',
   	/** 数据体，包含所有几何元素、项目和形状定义 */
   	Body = 'Body',
   	/** 设计指令, 定义文件的类型和意图 */
   	ProcessInstruction = 'ProcessInstruction',
   	/** 设计项目元素，表示 PCB 上的各种组件（板、元件、孔等） */
   	Item = 'Item',
   	/** 形状元素，定义项目的几何形状 */
   	ShapeElement = 'ShapeElement',
   	/** 2D 曲线集合，定义 2.5D 几何的 Z 轴范围 */
   	CurveSet2d = 'CurveSet2d',
   	/** 2D 笛卡尔坐标点 */
   	CartesianPoint = 'CartesianPoint',
   	/** 名称元素，用于标识各种对象 */
   	Name = 'Name',
   	/** 描述元素，提供对象的文本描述 */
   	Description = 'Description',
   	/** 系统作用域，定义对象的唯一命名空间 */
   	SystemScope = 'SystemScope',
   	/** 对象名称，在系统作用域内的唯一标识 */
   	ObjectName = 'ObjectName',
   	/** 全局长度单位设置 */
   	GlobalUnitLength = 'GlobalUnitLength',
   	/** 创建日期时间 */
   	CreationDateTime = 'CreationDateTime',
   	/** 修改日期时间 */
   	ModifiedDateTime = 'ModifiedDateTime',
   	/** 创建者姓名 */
   	CreatorName = 'CreatorName',
   	/** 创建者公司 */
   	CreatorCompany = 'CreatorCompany',
   	/** 创建者系统 */
   	CreatorSystem = 'CreatorSystem',
   	/** 后处理器信息 */
   	PostProcessor = 'PostProcessor',
   	/** 后处理器版本 */
   	PostProcessorVersion = 'PostProcessorVersion',
   	/** 创建者 */
   	Creator = 'Creator',
   }

   /**
    * IDX-PDM-命名空间标签枚举
    * 包含产品数据管理元素，位于 pdm 命名空间
    */
   export enum IDXPDMTag {
   	/** 项目类型，可以是 "assembly" 或 "single" */
   	ItemType = 'ItemType',
   	/** 唯一标识符，包含系统作用域、编号、版本、修订和序列号 */
   	Identifier = 'Identifier',
   	/** 编号，标识符的一部分 */
   	Number = 'Number',
   	/** 版本号，标识符的一部分 */
   	Version = 'Version',
   	/** 修订号，标识符的一部分 */
   	Revision = 'Revision',
   	/** 序列号，标识符的一部分，用于变更追踪 */
   	Sequence = 'Sequence',
   	/** 项目实例，表示项目中一个具体实例 */
   	ItemInstance = 'ItemInstance',
   	/** 实例名称 */
   	InstanceName = 'InstanceName',
   	/** 包名称，用于组件封装标识 */
   	PackageName = 'PackageName',
   	/** 形状引用，指向形状元素 */
   	Shape = 'Shape',
   	/** 变换矩阵，定义位置、旋转和缩放 */
   	Transformation = 'Transformation',
   	/** 变换类型，可以是 "d2" 或 "d3" */
   	TransformationType = 'TransformationType',
   	/** 基线标记，表示该项目是否属于基线 */
   	BaseLine = 'BaseLine',
   	/** 装配到名称，用于定义项目相对于层或表面的位置 */
   	AssembleToName = 'AssembleToName',
   	/** 参考名称，用于其他项目引用 */
   	ReferenceName = 'ReferenceName',
   	/** 层定义，表示 PCB 层 */
   	Stratum = 'Stratum',
   	/** 层类型，如 DesignLayerStratum */
   	StratumType = 'StratumType',
   	/** 层表面指定，如 PrimarySurface */
   	StratumSurfaceDesignation = 'StratumSurfaceDesignation',
   	/** 层技术定义 */
   	StratumTechnology = 'StratumTechnology',
   	/** 技术类型，如 Design 或 Documentation */
   	TechnologyType = 'TechnologyType',
   	/** 层用途，如 OtherSignal、SolderMask、SilkScreen 等 */
   	LayerPurpose = 'LayerPurpose',
   	/** 形状描述类型，如 GeometricModel */
   	ShapeDescriptionType = 'ShapeDescriptionType',
   	/** 形状元素类型，如 FeatureShapeElement、PartMountingFeature 等 */
   	ShapeElementType = 'ShapeElementType',
   	/** 定义形状，指向曲线集合 */
   	DefiningShape = 'DefiningShape',
   	/** 反转标记，用于布尔运算（false=添加，true=减去） */
   	Inverted = 'Inverted',
   	/** 弯曲元素，用于柔性板弯曲区域 */
   	Bend = 'Bend',
   	/** 弯曲类型，如 CircularBendType */
   	BendType = 'BendType',
   	/** 弯曲线，定义弯曲轴线 */
   	BendLine = 'BendLine',
   	/** 内侧，定义弯曲的内侧方向 */
   	InnerSide = 'InnerSide',
   	/** 内半径，弯曲的内侧半径 */
   	InnerRadius = 'InnerRadius',
   	/** 内角度，弯曲的角度 */
   	InnerAngle = 'InnerAngle',
   	/** 弯曲序列号，定义弯曲的应用顺序 */
   	bendSequenceNumber = 'bendSequenceNumber',
   }

   /**
    * IDX-D2-命名空间标签枚举
    * 包含 2D 几何元素，位于 d2 命名空间
    */
   export enum IDXD2Tag {
   	/** X 坐标 */
   	X = 'X',
   	/** Y 坐标 */
   	Y = 'Y',
   	/** Z 坐标 */
   	Z = 'Z',
   	/** 下边界，定义曲线集合的 Z 轴起始位置 */
   	LowerBound = 'LowerBound',
   	/** 上边界，定义曲线集合的 Z 轴结束位置 */
   	UpperBound = 'UpperBound',
   	/** 详细几何模型元素，指向具体的几何元素 */
   	DetailedGeometricModelElement = 'DetailedGeometricModelElement',
   	/** 多段线，由一系列点定义的折线 */
   	PolyLine = 'PolyLine',
   	/** 点，多段线中的点 */
   	Point = 'Point',
   	/** 厚度，多段线的宽度（如用于走线或铣削路径） */
   	Thickness = 'Thickness',
   	/** 圆弧 */
   	Arc = 'Arc',
   	/** 圆（三点式） */
   	Circle3Point = 'Circle3Point',
   	/** 圆（圆心直径式） */
   	CircleCenter = 'CircleCenter',
   	/** 椭圆 */
   	Ellipse = 'Ellipse',
   	/** 抛物线 */
   	Parabola = 'Parabola',
   	/** B样条曲线 */
   	BSplineCurve = 'BSplineCurve',
   	/** 复合曲线，由多条曲线组合而成 */
   	CompositeCurve = 'CompositeCurve',
   	/** 偏移曲线 */
   	OffsetCurve = 'OffsetCurve',
   	/** 修剪曲线 */
   	TrimmedCurve = 'TrimmedCurve',
   	/** 直线，由点和向量定义 */
   	Line = 'Line',
   	/** 向量，定义直线的方向 */
   	Vector = 'Vector',
   	/** 坐标点 */
   	EDMDCartesianPoint = 'EDMDCartesianPoint',
   }

   /**
    * IDX-Property-命名空间标签枚举
    * 包含属性定义元素，位于 property 命名空间
    */
   export enum IDXPropertyTag {
   	/** 简单用户属性 */
   	EDMDUserSimpleProperty = 'EDMDUserSimpleProperty',
   	/** 长度属性 */
   	EDMDLengthProperty = 'EDMDLengthProperty',
   	/** 逻辑属性（布尔值） */
   	EDMDLogicProperty = 'EDMDLogicProperty',
   	/** 通用属性 */
   	EDMDProperty = 'EDMDProperty',
   	/** 键，属性键名 */
   	Key = 'Key',
   	/** 值，属性值 */
   	Value = 'Value',
   	/** 属性是否已更改 */
   	IsChanged = 'IsChanged',
   	/** 属性是否为新属性 */
   	IsNew = 'IsNew',
   	/** 属性是否持久化 */
   	Persistent = 'Persistent',
   	/** 属性是否源自原始创建者 */
   	IsOriginator = 'IsOriginator',
   	/** 属性是否已更改（属性级别） */
   	IsAttributeChanged = 'IsAttributeChanged',
   }

   /**
    * IDX-Computational-命名空间标签枚举
    * 包含计算与处理指令元素，位于 computational 命名空间
    */
   export enum IDXComputationalTag {
   	/** 处理指令-发送信息（基线） */
   	SendInformation = 'EDMDProcessInstructionSendInformation',
   	/** 处理指令-发送变更（变更提议或响应） */
   	SendChanges = 'EDMDProcessInstructionSendChanges',
   	/** 处理指令-请求信息 */
   	RequestForInformation = 'EDMDProcessInstructionRequestForInformation',
   	/** 执行者，发起操作的用户或系统 */
   	Actor = 'Actor',
   	/** 变更集合 */
   	Changes = 'Changes',
   	/** 单个变更定义 */
   	Change = 'Change',
   	/** 新项目引用 */
   	NewItem = 'NewItem',
   	/** 前驱项目引用 */
   	PredecessorItem = 'PredecessorItem',
   	/** 事务记录 */
   	EDMDTransaction = 'EDMDTransaction',
   	/** 删除的实例名称 */
   	DeletedInstanceName = 'DeletedInstanceName',
   }

   /**
    * IDX-Administration-命名空间标签枚举
    * 包含管理与权限元素，位于 administration 命名空间
    */
   export enum IDXAdministrationTag {
   	/** 项目实例上的角色定义 */
   	RoleOnItemInstance = 'RoleOnItemInstance',
   	/** 角色名称 */
   	RoleName = 'RoleName',
   	/** 角色类型，如 owner */
   	RoleType = 'RoleType',
   	/** 角色类别，如 Mechanical、Electrical */
   	Category = 'Category',
   	/** 功能，如 Design */
   	Function = 'Function',
   	/** 上下文，指向项目实例 */
   	Context = 'Context',
   }

   /**
    * IDX-XSI-命名空间标签枚举
    * XML Schema Instance 命名空间，位于 xsi 命名空间
    * 参考：W3C XML Schema Part 1: Structures (https://www.w3.org/TR/xmlschema-1/)
    * 注意：这些主要用于属性，不是元素
    */
   export enum IDXXSITag {
   	/** XML Schema Instance 类型属性，用于指定元素的具体类型 */
   	type = 'type',
   	/** XML Schema 位置属性，指定用于验证的 XML Schema 文件位置 */
   	schemaLocation = 'schemaLocation',
   	/** nil 属性，表示元素为空 */
   	nil = 'nil',
   }

   /**
    * 所有 IDX 标签的联合类型
    * 用于类型安全的标签引用
    */
   export type IDXTag = IDXFoundationTag | IDXPDMTag | IDXD2Tag | IDXPropertyTag | IDXComputationalTag | IDXAdministrationTag | IDXXSITag;

   /** IDX 处理指令类型 */
   export type IDXProcessInstruction = IDXComputationalTag.SendInformation | IDXComputationalTag.SendChanges | IDXComputationalTag.RequestForInformation;
   ```

8. `src/types/core/shape-element.types.ts`

   ```ts
   import { EDMDObject } from './base.types';
   import { StratumType, StratumSurfaceDesignation, ShapeElementType } from './enums';
   
   // ============= 形状元素 =============
   
   /**
    * 形状元素
    *
    * @remarks
    * 连接曲线集和项目定义的中介，支持布尔运算
    * REF: Section 4.1.2 (Table 2)
    * XML: <foundation:ShapeElement xsi:type="pdm:EDMDShapeElement">
    */
   export interface EDMDShapeElement extends EDMDObject {
   	/** 形状元素类型 */
   	ShapeElementType: ShapeElementType;
   	/** 布尔运算标记：false=添加材料，true=减去材料 */
   	Inverted: boolean;
   	/** 引用的曲线集id */
   	DefiningShape: string;
   }
   
   // ============= 层定义（传统方式） =============
   
   /**
    * 层定义（传统方式）
    *
    * @remarks
    * 在传统IDX结构中用作"Third Item"，在简化方式中可省略
    * REF: Section 6.1.2.1
    */
   export interface EDMDStratum extends EDMDObject {
   	/** 引用的形状元素id列表 */
   	ShapeElements: string[];
   	/** 层类型 */
   	StratumType: StratumType;
   	/** 层表面指定 */
   	StratumSurfaceDesignation?: StratumSurfaceDesignation;
   	/** 层技术引用 */
   	StratumTechnology?: string;
   }
   ```
#### types/ecad/

1. `src/types/ecad/ecad.interface.ts`

   ```ts
   /** ECAD 系统数据 */
   export interface ECADData {
   	// TODO: 待完善
   }
   ```

#### types/exporter/

1. `src/types/exporter/builder/idx-builder.interface.ts`

   ```ts
   import { GlobalUnit } from '../../core/base.types';

   /** IDX 模型构建配置 */
   export interface IDXBuildConfig {
   	/** 是否使用简化表示法(geometryType) */
   	useSimplified: boolean;
   	/** 全局单位 */
   	unit: GlobalUnit;
   	/** 几何精度(小数位数) */
   	precision: number;
   }
   ```

2. `src/types/exporter/idx-exporter/idx-exporter.interface.ts`

   ```ts
   import { IDXBuildConfig } from '../builder/idx-builder.interface';
   import { IDXWriteConfig } from '../writer/idx-writer.interface';

   // ============= 导出配置接口 =============
   /**
    * IDX 格式导出-配置
    *
    * @remarks
    * 控制IDX文件生成的各种选项
    */
   export interface IDXExportConfig {
   	/** 输出配置 */
   	output: IDXExportOutputConfig;
   	/** 协作选项 */
   	collaboration: IDXExportCollaborateOptions;
   	/** 验证选项 */
   	validation: IDXExportValidateOptions;
   	/** 模型构建配置 */
   	buildConfig?: IDXBuildConfig;
   	/** 格式生成配置 */
   	writeConfig?: IDXWriteConfig;
   }

   /** IDX 格式导出-输出配置 */
   export interface IDXExportOutputConfig {
   	/** 设计名称（用于文件名生成） */
   	designName: string;
   	/** 输出目录 */
   	directory?: string;
   }

   /** IDX 格式导出-协作选项 */
   export interface IDXExportCollaborateOptions {
   	/** 创建者系统名称 */
   	creatorSystem: string;
   	/** 创建者公司 */
   	creatorCompany: string;
   }

   /** IDX 格式导出-输出配置 */
   export interface IDXExportValidateOptions {
   	/** 是否在导出时验证数据 */
   	enabled: boolean;
   }

   // ============= 导出结果接口 =============
   /**
    * IDX导出结果
    *
    * @remarks
    * 包含导出操作的结果和统计信息
    */
   export interface IDXExportResult {
   	/** 是否成功 */
   	success: boolean;
   	/** 导出的文件信息 */
   	files: IDXFileMetadata;
   	/** 统计信息 */
   	statistics: IDXStatistics;
   	/** 错误和警告 */
   	issues: IDXError[];
   	/** 验证结果 */
   	validation?: IDXValidation;
   }

   /**
    * IDX文件元数据
    *
    * @remarks
    * 包含文件类型、名称和路径信息
    */
   export interface IDXFileMetadata {
   	/** 文件名（不包含扩展名） */
   	name: string;
   	/** 完整文件路径 */
   	path: string;
   	/** 创建时间戳 */
   	timestamp: string;
   	/** 序列号 */
   	sequence: number;
   	/** 设计名称 */
   	designName: string;
   }

   /** IDX统计信息 */
   export interface IDXStatistics {
   	/** 层数量 */
   	layers: number;
   	/** 项目总数 */
   	totalItems: number;
   	/** 组件数量 */
   	components: number;
   	/** 孔数量 */
   	holes: number;
   	/** 保持区域数量 */
   	keepouts: number;
   	/** 文件大小（字节） */
   	fileSize: number;
   	/** 导出耗时（毫秒） */
   	exportDuration: number;
   }

   /** IDX错误信息 */
   export interface IDXError {
   	type: 'error' | 'warning' | 'info';
   	code: string;
   	message: string;
   	itemId?: string;
   }

   /** IDX验证结果 */
   export interface IDXValidation {
   	passed: boolean;
   	errors: string[];
   	warnings: string[];
   }
   ```

3. `src/types/exporter/writer/idx-writer.interface.ts`

   ```ts
   /** IDX 格式生成配置 */
   export type IDXWriteConfig = Partial<{
   	/**
   	 * 自定义命名空间表(非官方规范命名空间)
   	 * @example {'foundation': 'http://www.prostep.org/EDMD/Foundation'}
   	 */
   	namespaces: Record<string, string>;
   	/** 是否启用注释 */
   	enableComments: boolean;
   	/** 格式化配置 */
   	formatting: IDXWriterFormatting;
   }>;
   
   /** IDX 格式生成器-格式化配置 */
   export type IDXWriterFormatting = Partial<{
   	/** 美化输出 */
   	prettyPrint: boolean;
   }>;
   ```

### utils/

1. `src/utils/array.utils.ts`

   ```ts
   /** 遍历数组 */
   export function iterateArr<V>(arr: V[] | undefined, cb: (value: V, index: number, baseArr: V[]) => boolean | void): boolean {
   	if (!arr) {
   		return false;
   	}
   	return arr.some(cb);
   }
   ```

2. `src/utils/number.utils.ts`

   ```ts
   /** 是否为有效数字 */
   export function isNumeric(number: string | number | undefined) {
   	return number !== undefined && isValidNumber(parseFloat(number.toString()));
   }

   /** 是否为有效数字 */
   export function isValidNumber(value: number | undefined) {
   	return typeof value == 'number' && !Number.isNaN(value) && isFinite(value);
   }
   ```

3. `src/utils/object.utils.ts`

   ```ts
   /** 将任意值转换为布尔值 */
   export function toBoolean(value: unknown): boolean {
   	return Boolean(value);
   }
   
   /** 将任意类型转换为字符串 */
   export function toString(obj: unknown, defaultStr = ''): string {
   	return isNone(obj) ? defaultStr : String(obj);
   }
   
   export function isObject(obj: unknown): boolean {
   	return obj ? typeof obj == 'object' : false;
   }
   
   /** 是否为空（undefined, null, ''） */
   export function isNone(obj: unknown): boolean {
   	return Object.is(obj, undefined) || Object.is(obj, null) || Object.is(obj, '');
   }
   
   /** 是否为对象自有属性 */
   export function hasOwnProperty(obj: any, key: PropertyKey): boolean {
   	return obj ? Object.hasOwnProperty.call(obj, key) : false;
   }
   
   /** 遍历对象 */
   export function iterateObject<V>(obj: Record<string, V> | undefined, cb: (value: V, ket: string, obj: Record<string, V>) => boolean | void): boolean {
   	if (!obj) {
   		return false;
   	}
   	for (const key in obj) {
   		const value = obj[key] as V;
   		if (cb(value, key, obj)) {
   			return true;
   		}
   	}
   	return false;
   }
   ```